{% extends "app/base.html" %}
{% load static %}
{% block title %}My Specials{% endblock %}
{% block content %}
<style>
  /* show-only-10-items, but scrollable; hide scrollbar */
  .subs-scroll {
    --row-h:60px;
    /* tweak to your actual <li> height */
    max-height: calc(var(--row-h) * 10);
    overflow: auto;

    /* hide scrollbar (Firefox/IE/Edge Legacy) */
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  .subs-scroll::-webkit-scrollbar {
    /* hide scrollbar (WebKit) */
    width: 0;
    height: 0;
  }
</style>
<style>
  /* subtle top border accent using your #f08000 */
  .card-header {
    border-top: 4px solid #f08000;
  }
</style>
<div class="container py-4 px-2">


  <div class="row g-4 my-3">
    <div class="col-lg-12">

      {% include "app/partials/specials_list.html" with specials=specials %}
  
    </div>
  </div>
    <div class="row g-4">
    <div class="col-lg-6">
    
      {% include "profiles/card.html" with profile=profile %}
  
    </div>
    <!-- Aggregated Stats -->

    <div class="col-lg-6">
   
      {% include "app/stats/widget.html" with profile=profile specials=specials top_special=top_special stats=stats selected_special=None %}
  
    </div>

  </div>
  <div class="row g-4 mt-4 align-items-top">




    <div class="col-lg-6">
      <div class="card h-100">
        <div class="card-header">Billing</div>
        <div class="card-body">

          <!-- Free Plan -->
          <div class="card mb-3 border-success shadow-sm">
            <div class="card-body d-flex justify-content-between align-items-center">
              <div>
                <div class="fw-bold text-success">
                  <i class="fa-solid fa-circle-check me-2"></i>
                  Free Plan
                </div>
                <div class="small text-muted">Currently subscribed</div>
              </div>
              <span class="badge bg-success-subtle text-success fw-semibold">Active</span>
            </div>
          </div>

          <!-- Pro Plan -->
          <div class="card mb-3 border-secondary">
            <div class="card-body">
              <div class="fw-bold">
                <i class="fa-solid fa-rocket me-2 text-secondary"></i>
                Pro Plan
              </div>
              <div class="small text-muted">Coming soon</div>
            </div>
          </div>

          <!-- Enterprise Plan -->
          <div class="card border-secondary">
            <div class="card-body">
              <div class="fw-bold">
                <i class="fa-solid fa-building me-2 text-secondary"></i>
                Enterprise Plan
              </div>
              <div class="small text-muted">Coming soon</div>
            </div>
          </div>

        </div>
      </div>
    </div>

    <div class="col-lg-6">
      {% include "app/subscribers/panel.html" with profile=request.user.userprofile %}


    </div>
  </div>


  <div class="card mt-4">
    <div class="card-header d-flex justify-content-between align-items-center">
      <span>Integrations</span>

    </div>
    <div class="card-body">
      <p class="text-secondary">Connect platforms to auto-post specials, sync menus, and track conversions.</p>

      <div class="row row-cols-1 row-cols-md-2 g-3">

        {# Uber Eats #}
        <div class="col">
          <div class="border rounded p-3 d-flex align-items-center justify-content-between">
            <div>
              <div class="fw-semibold">Uber Eats</div>
              <div class="small text-secondary">Auto-post specials to your Uber Eats storefront.</div>
            </div>
            <div class="text-end">
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="int-uber" {% if integration_status.uber_eats %}checked{% endif %} 
                hx-post="{% url 'integrations_toggle' 'uber_eats' %}" hx-trigger="change"
                  hx-vals='{"enabled": this.checked}' {% if not request.user.userprofile.is_premium %}disabled{% endif %}>
                <label class="form-check-label small" for="int-uber">
                  {% if integration_status.uber_eats %}<span class="text-success">Connected</span>{% else %}Off{% endif %}
                </label>
              </div>
              <a class="btn btn-sm btn-outline-dark mt-2"
                href="{% url 'integrations_connect' 'uber_eats' %}">Configure</a>
            </div>
          </div>
        </div>

        {# DoorDash #}
        <div class="col">
          <div class="border rounded p-3 d-flex align-items-center justify-content-between">
            <div>
              <div class="fw-semibold">DoorDash</div>
              <div class="small text-secondary">Sync specials to promotions and menu highlights.</div>
            </div>
            <div class="text-end">
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="int-doordash" {% if integration_status.doordash %}checked{% endif %}
                 hx-post="{% url 'integrations_toggle' 'doordash' %}" hx-trigger="change"
                  hx-vals='{"enabled": this.checked}' {% if not request.user.userprofile.is_premium %}disabled{% endif %}>
                <label class="form-check-label small" for="int-doordash">
                  {% if integration_status.doordash %}<span class="text-success">Connected</span>{% else %}Off{% endif %}
                </label>
              </div>
              <a class="btn btn-sm btn-outline-dark mt-2"
                href="{% url 'integrations_connect' 'doordash' %}">Configure</a>
            </div>
          </div>
        </div>

        {# Google Business Profile #}
        <div class="col">
          <div class="border rounded p-3 d-flex align-items-center justify-content-between">
            <div>
              <div class="fw-semibold">Google</div>
              <div class="small text-secondary">Post updates to Google Business Profile.</div>
            </div>
            <div class="text-end">
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="int-google" {% if integration_status.google %}checked{% endif %}
                 hx-post="{% url 'integrations_toggle' 'google' %}" hx-trigger="change"
                  hx-vals='{"enabled": this.checked}' {% if not request.user.userprofile.is_premium %}disabled{% endif %}>
                <label class="form-check-label small" for="int-google">
                  {% if integration_status.google %}<span class="text-success">Connected</span>{% else %}Off{% endif %}
                </label>
              </div>
              {% if integration_status.google %}
              <a class="btn btn-sm btn-outline-dark mt-2" href="{% url 'integrations_connect' 'google' %}">Configure</a>
              {% else %}
              <a class="btn btn-sm btn-outline-primary mt-2"
                href="{% url 'integrations_connect' 'google' %}">Connect</a>
              {% endif %}
            </div>
          </div>
        </div>

        {# Apple Maps / Apple Business #}
        <div class="col">
          <div class="border rounded p-3 d-flex align-items-center justify-content-between">
            <div>
              <div class="fw-semibold">Apple</div>
              <div class="small text-secondary">Share promos via Apple Business Connect.</div>
            </div>
            <div class="text-end">
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="int-apple" {% if integration_status.apple %}checked{% endif %} 
                hx-post="{% url 'integrations_toggle' 'apple' %}" hx-trigger="change"
                  hx-vals='{"enabled": this.checked}' {% if not request.user.userprofile.is_premium %}disabled{% endif %}>
                <label class="form-check-label small" for="int-apple">
                  {% if integration_status.apple %}<span class="text-success">Connected</span>{% else %}Off{% endif %}
                </label>
              </div>
              <a class="btn btn-sm btn-outline-dark mt-2" href="{% url 'integrations_connect' 'apple' %}">Configure</a>
            </div>
          </div>
        </div>

        {# POS examples: Square, Toast (toggle whichever you support) #}
        <div class="col">
          <div class="border rounded p-3 d-flex align-items-center justify-content-between">
            <div>
              <div class="fw-semibold">Square POS</div>
              <div class="small text-secondary">Pull items; push “Special” tags to POS.</div>
            </div>
            <div class="text-end">
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="int-square" {% if integration_status.square %}checked{% endif %} hx-post="{% url 'integrations_toggle' 'square' %}" hx-trigger="change"
                  hx-vals='{"enabled": this.checked}' {% if not request.user.userprofile.is_premium %}disabled{% endif %}>
                <label class="form-check-label small" for="int-square">
                  {% if integration_status.square %}<span class="text-success">Connected</span>{% else %}Off{% endif %}
                </label>
              </div>
              <a class="btn btn-sm btn-outline-dark mt-2" href="{% url 'integrations_connect' 'square' %}">Configure</a>
            </div>
          </div>
        </div>

        <div class="col">
          <div class="border rounded p-3 d-flex align-items-center justify-content-between">
            <div>
              <div class="fw-semibold">Toast POS</div>
              <div class="small text-secondary">Sync specials with Toast menus.</div>
            </div>
            <div class="text-end">
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="int-toast" {% if integration_status.toast %}checked{% endif %} 
                hx-post="{% url 'integrations_toggle' 'toast' %}" hx-trigger="change"
                  hx-vals='{"enabled": this.checked}' {% if not request.user.userprofile.is_premium %}disabled{% endif %}>
                <label class="form-check-label small" for="int-toast">
                  {% if integration_status.toast %}<span class="text-success">Connected</span>{% else %}Off{% endif %}
                </label>
              </div>
              <a class="btn btn-sm btn-outline-dark mt-2" href="{% url 'integrations_connect' 'toast' %}">Configure</a>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

</div>
{% endblock %}